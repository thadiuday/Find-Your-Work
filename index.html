<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Find Your Work</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
    }
    h2, h3 {
      text-align: center;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      box-sizing: border-box;
      font-size: 1em;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    #postList div {
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <h2>Post a Job or Find Work</h2>

  <form id="submitForm">
    <input type="text" id="name" placeholder="Your Name" required />
    <input type="text" id="work" placeholder="Type of Work" required />
    <input type="text" id="phone" placeholder="Phone Number" required />
    <button type="submit">Submit Post</button>
  </form>

  <h3>Latest Posts</h3>
  <div id="postList"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBf_rZvgtxviFjdvQgkS8T2IP41xpBppos",
      authDomain: "find-your-work-5193f.firebaseapp.com",
      projectId: "find-your-work-5193f",
      storageBucket: "find-your-work-5193f.firebasestorage.app",
      messagingSenderId: "519830450009",
      appId: "1:519830450009:web:37bc8d0e2f5870fcdc6648",
      measurementId: "G-6HFHWMG083"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const postsRef = ref(db, 'posts/');

    document.getElementById("submitForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const work = document.getElementById("work").value.trim();
      const phone = document.getElementById("phone").value.trim();

      if (name && work && phone) {
        push(postsRef, { name, work, phone })
          .then(() => {
            alert("✅ Post submitted!");
            e.target.reset();
          })
          .catch((error) => {
            console.error("Error submitting:", error);
            alert("❌ Submission failed. Check console.");
          });
      }
    });

    onValue(postsRef, (snapshot) => {
      const postList = document.getElementById("postList");
      postList.innerHTML = "";

      snapshot.forEach((childSnapshot) => {
        const data = childSnapshot.val();
        const div = document.createElement("div");
        div.innerHTML = `
          <strong>${data.name}</strong><br>
          Work: ${data.work}<br>
          Phone: ${data.phone}
        `;
        postList.appendChild(div);
      });
    });
  </script>

</body>
</html>
